<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <title>Neuer Spieler FC Rheineck – Anmeldung</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      --fc-blue: #1e3a8a;
      --fc-red:  #dc2626;
      --bg:      #f7f7f9;
      --text:    #111827;
      --muted:   #6b7280;
      --card:    #ffffff;
      --border:  #e5e7eb;
    }
    * { box-sizing: border-box; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 0; background: var(--bg); color: var(--text); }
    header { background: linear-gradient(90deg, var(--fc-blue), var(--fc-red)); color: #fff; padding: 20px 24px; }
    header h1 { margin: 0; font-size: 22px; }
    .wrap { max-width: 920px; margin: 28px auto; padding: 0 16px; }
    .card { background: var(--card); padding: 28px; border-radius: 14px; box-shadow: 0 8px 22px rgba(0,0,0,.06); border:1px solid var(--border); }
    label { font-weight: 600; margin-top: 12px; display:block; }
    input, select { width: 100%; padding: 10px; border-radius: 10px; border: 1px solid var(--border); margin-top: 6px; font-size:16px; }
    .btn { padding: 12px 16px; border:0; border-radius: 999px; font-size: 16px; cursor: pointer; font-weight: 700; text-decoration:none; display:inline-block; }
    .btn-primary { background: var(--fc-red); color:#fff; }
    .btn-secondary { background: var(--fc-blue); color:#fff; }
    .modal-backdrop { display:none; position:fixed; inset:0; background:rgba(0,0,0,.6); align-items:center; justify-content:center; padding:16px; }
    .modal-backdrop.show { display:flex; }
    .modal { background:#fff; padding:20px; border-radius:12px; max-width:720px; width:100%; }
  </style>
</head>
<body>
  <header><h1>Neuer Spieler FC Rheineck</h1></header>

  <div class="wrap">
    <div class="card">
      <form id="anmeldungForm"
            action="https://formsubmit.co/mniederer21@gmail.com"
            method="POST"
            enctype="multipart/form-data"
            accept-charset="utf-8">

        <!-- Formsubmit-Optionen -->
        <input type="hidden" name="_subject" value="Neuer Spieler – FC Rheineck">
        <input type="hidden" name="_template" value="table">
        <input type="hidden" name="_captcha" value="false">
        <input type="hidden" name="_next"
       value="https://marsl21.github.io/Neuer-Spieler-FC-Rheineck/danke.html">


        <label>Art der Anmeldung *</label>
        <select name="Anmeldung" id="typ" required>
          <option value="">Bitte wählen</option>
          <option>Neuanmeldung</option>
          <option>Transfer CH</option>
          <option>Transfer aus dem Ausland</option>
        </select>

        <label>Vorname *</label>
        <input type="text" name="Vorname" required autocomplete="given-name">

        <label>Name *</label>
        <input type="text" name="Name" required autocomplete="family-name">

        <label>Strasse *</label>
        <input type="text" name="Strasse" required autocomplete="address-line1">

        <label>PLZ *</label>
        <input type="text" name="PLZ" required inputmode="numeric" pattern="^[0-9]{4}$" title="Vierstellige Schweizer PLZ">

        <label>Ort *</label>
        <input type="text" name="Ort" required autocomplete="address-level2">

        <label>E-Mailadresse *</label>
        <input type="email" name="Email" required autocomplete="email">

        <label>Tel.Nr. *</label>
        <input type="tel" name="Telefon" required placeholder="+41 79 123 45 67" pattern="^[0-9+()\\-\\s]{7,20}$" title="Bitte gültige Telefonnummer angeben">

        <label>Geburtsdatum *</label>
        <input type="date" name="Geburtsdatum" required>

        <div id="ausweisBlock" style="margin-top:10px;">
          <label>ID Vorderseite (nur bei Neuanmeldung)</label>
          <input type="file" name="ID_Vorne" id="idV" accept="image/*,.pdf">

          <label>ID Rückseite (nur bei Neuanmeldung)</label>
          <input type="file" name="ID_Hinten" id="idR" accept="image/*,.pdf">
        </div>

        <label>Foto vom Spieler *</label>
        <input type="file" name="Foto" id="foto" accept="image/*" required>

        <!-- Versteckter nativer Submit-Button (garantiert POST) -->
        <button type="submit" id="real-submit" style="display:none" aria-hidden="true"></button>

        <div style="margin-top:16px;">
          <button type="button" class="btn btn-primary" id="btn-show-summary">Weiter zur Übersicht</button>
          <button type="reset" class="btn btn-secondary">Zurücksetzen</button>
        </div>

        <p style="color:#6b7280;margin-top:10px;">Hinweis: Bilder zu Gross? Tipp: sende dir die Bilder selbst per Whats'app und speichere sie auf dem Handy. Dann versuche es nochmals. ;)</p>
      </form>
    </div>
  </div>

  <!-- Modal: Zusammenfassung -->
  <div class="modal-backdrop" id="modal-backdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="summaryTitle">
      <h3 id="summaryTitle">Bitte prüfe deine Angaben</h3>
      <div id="summary"></div>
      <div style="margin-top:12px; display:flex; gap:10px; justify-content:flex-end;">
        <button class="btn btn-secondary" id="btn-cancel" type="button">Abbrechen</button>
        <button class="btn btn-primary" id="btn-submit" type="button">Jetzt senden</button>
      </div>
    </div>
  </div>

<script>
  const form = document.getElementById('anmeldungForm');
  const typ  = document.getElementById('typ');
  const btnShowSummary = document.getElementById('btn-show-summary');
  const btnSubmit = document.getElementById('btn-submit');
  const btnCancel = document.getElementById('btn-cancel');
  const backdrop = document.getElementById('modal-backdrop');
  const summaryDiv = document.getElementById('summary');
  const idV = document.getElementById('idV');
  const idR = document.getElementById('idR');
  const foto = document.getElementById('foto');
  const MAX_TOTAL_MB = 5;

  // Bei Neuanmeldung sind die Ausweis-Felder Pflicht, sonst nicht
  function toggleAusweisPflicht() {
    const isNeu = typ.value === 'Neuanmeldung';
    idV.required = isNeu;
    idR.required = isNeu;
  }
  typ.addEventListener('change', toggleAusweisPflicht);
  toggleAusweisPflicht();

  function fileSizeMB(f){ return f ? (f.size/1024/1024) : 0; }
  function totalSizeMB(){
    let sum = 0;
    if (idV.files[0]) sum += fileSizeMB(idV.files[0]);
    if (idR.files[0]) sum += fileSizeMB(idR.files[0]);
    if (foto.files[0]) sum += fileSizeMB(foto.files[0]);
    return sum;
  }
  function enforceTotalLimit(){
    const sum = totalSizeMB();
    if (sum > MAX_TOTAL_MB){
      alert(`Die Gesamtgrösse der Anhänge beträgt ${sum.toFixed(2)} MB und überschreitet das Limit von ${MAX_TOTAL_MB} MB.`);
      return false;
    }
    return true;
  }
  [idV, idR, foto].forEach(el => el && el.addEventListener('change', enforceTotalLimit));

  function filename(input){ return input.files[0] ? input.files[0].name : '—'; }
  function add(label,value){ summaryDiv.innerHTML += `<p><strong>${label}:</strong> ${value}</p>`; }

  btnShowSummary.addEventListener('click', () => {
    if (!form.reportValidity()) return;
    if (!enforceTotalLimit()) return;

    summaryDiv.innerHTML = '';
    // Textfelder/Select
    const fields = ['Anmeldung','Vorname','Name','Strasse','PLZ','Ort','Email','Telefon','Geburtsdatum'];
    fields.forEach(n => {
      const el = form.elements[n];
      if (el) add(n, el.value);
    });
    // Dateien
    add('ID Vorderseite', filename(idV));
    add('ID Rückseite', filename(idR));
    add('Foto vom Spieler', filename(foto));
    add('Gesamtgrösse Anhänge', `${totalSizeMB().toFixed(2)} MB (Limit: ${MAX_TOTAL_MB} MB)`);

    backdrop.classList.add('show');
    backdrop.setAttribute('aria-hidden','false');
  });

  btnSubmit.addEventListener('click', () => {
    if (!enforceTotalLimit()) return;
    backdrop.classList.remove('show');
    backdrop.setAttribute('aria-hidden','true');
    if (typeof form.requestSubmit === 'function') {
      form.requestSubmit();                // nativer Submit → POST
    } else {
      document.getElementById('real-submit').click(); // Fallback
    }
  });

  btnCancel.addEventListener('click', () => {
    backdrop.classList.remove('show');
    backdrop.setAttribute('aria-hidden','true');
  });
</script>
</body>

</html>
